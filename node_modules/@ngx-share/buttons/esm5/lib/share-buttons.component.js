/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Output, EventEmitter, ChangeDetectionStrategy } from '@angular/core';
import { ShareButtons } from '@ngx-share/core';
import { BehaviorSubject } from 'rxjs';
import { map } from 'rxjs/operators';
/**
 * @record
 */
export function ButtonsState() { }
function ButtonsState_tsickle_Closure_declarations() {
    /** @type {?|undefined} */
    ButtonsState.prototype.includedButtons;
    /** @type {?|undefined} */
    ButtonsState.prototype.excludedButtons;
    /** @type {?|undefined} */
    ButtonsState.prototype.userButtons;
    /** @type {?|undefined} */
    ButtonsState.prototype.selectedButtons;
    /** @type {?|undefined} */
    ButtonsState.prototype.expanded;
    /** @type {?|undefined} */
    ButtonsState.prototype.shownCount;
    /** @type {?|undefined} */
    ButtonsState.prototype.moreIcon;
    /** @type {?|undefined} */
    ButtonsState.prototype.lessIcon;
}
var ShareButtonsComponent = /** @class */ (function () {
    function ShareButtonsComponent(_share) {
        this._share = _share;
        this._stateWorker$ = new BehaviorSubject({
            includedButtons: [],
            excludedButtons: [],
            userButtons: [],
            selectedButtons: [],
            expanded: true,
            shownCount: Object.keys(this._share.config.prop).length
        });
        this.theme = this._share.theme;
        /**
         * Show buttons icon
         */
        this.showIcon = true;
        /**
         * Show buttons name
         */
        this.showText = false;
        /**
         * Show buttons share count
         */
        this.showCount = false;
        /**
         * Buttons size
         */
        this.size = 0;
        /**
         * Share count event
         */
        this.count = new EventEmitter();
        /**
         * Share dialog opened event
         */
        this.opened = new EventEmitter();
        /**
         * Share dialog closed event
         */
        this.closed = new EventEmitter();
    }
    Object.defineProperty(ShareButtonsComponent.prototype, "includedButtons", {
        set: /**
         * @param {?} includedButtons
         * @return {?}
         */
        function (includedButtons) {
            this.updateState({ includedButtons: includedButtons });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ShareButtonsComponent.prototype, "excludedButtons", {
        set: /**
         * @param {?} excludedButtons
         * @return {?}
         */
        function (excludedButtons) {
            this.updateState({ excludedButtons: excludedButtons });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ShareButtonsComponent.prototype, "shownButtons", {
        set: /**
         * @param {?} shownCount
         * @return {?}
         */
        function (shownCount) {
            this.updateState({ shownCount: shownCount });
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ShareButtonsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.state$ = this._stateWorker$.pipe(map(function (state) {
            // Use component include buttons, otherwise fallback to global include buttons
            var /** @type {?} */ includedButtons = state.includedButtons.length ? state.includedButtons : state.userButtons;
            var /** @type {?} */ userButtons = includedButtons.filter(function (btn) { return state.excludedButtons.indexOf(btn) < 0; });
            var /** @type {?} */ selectedButtons = userButtons.slice(0, state.expanded ? userButtons.length : state.shownCount);
            return {
                userButtons: userButtons,
                selectedButtons: selectedButtons,
                expanded: state.expanded,
                shownCount: state.shownCount,
                moreIcon: state.moreIcon,
                lessIcon: state.lessIcon
            };
        }));
        /** Subscribe to share buttons config changes, This updates the component whenever a new button is added */
        this._configSub$ = this._share.config$.subscribe(function (config) {
            // Use global include buttons, otherwise fallback to all buttons
            var /** @type {?} */ includedButtons = config.options.include.length ? config.options.include : Object.keys(config.prop);
            var /** @type {?} */ userButtons = includedButtons.filter(function (btn) { return config.options.exclude.indexOf(btn) < 0; });
            _this.updateState({
                userButtons: userButtons,
                expanded: false,
                moreIcon: config.options.moreButtonIcon,
                lessIcon: config.options.lessButtonIcon
            });
        });
    };
    /**
     * @return {?}
     */
    ShareButtonsComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this._configSub$) {
            this._configSub$.unsubscribe();
        }
        this._stateWorker$.complete();
    };
    /**
     * @param {?} state
     * @return {?}
     */
    ShareButtonsComponent.prototype.updateState = /**
     * @param {?} state
     * @return {?}
     */
    function (state) {
        this._stateWorker$.next(tslib_1.__assign({}, this._stateWorker$.getValue(), state));
    };
    ShareButtonsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'share-buttons',
                    template: "<div *ngIf=\"state$ | async; let state\" class=\"sb-group sb-{{theme}}\">\n\n  <share-button *ngFor=\"let button of state.selectedButtons\"\n                [button]=\"button\"\n                [theme]=\"theme\"\n                [url]=\"url\"\n                [title]=\"title\"\n                [description]=\"description\"\n                [image]=\"image\"\n                [tags]=\"tags\"\n                [autoSetMeta]=\"autoSetMeta\"\n                [showCount]=\"showCount\"\n                [showIcon]=\"showIcon\"\n                [showText]=\"showText\"\n                [size]=\"size\"\n                (opened)=\"opened.emit($event)\"\n                (closed)=\"closed.emit($event)\"\n                (count)=\"count.emit($event)\"></share-button>\n\n  <div class=\"sb-button sb-{{theme}}\">\n\n    <expand-button *ngIf=\"state.shownCount < state.userButtons.length\"\n                   [expanded]=\"state.expanded\"\n                   [moreIcon]=\"state.moreIcon\"\n                   [lessIcon]=\"state.lessIcon\"\n                   [size]=\"(1 + size/20) * 14\"\n                   (toggle)=\"updateState({expanded: $event})\">\n    </expand-button>\n\n  </div>\n</div>\n",
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    preserveWhitespaces: false
                },] },
    ];
    /** @nocollapse */
    ShareButtonsComponent.ctorParameters = function () { return [
        { type: ShareButtons }
    ]; };
    ShareButtonsComponent.propDecorators = {
        theme: [{ type: Input }],
        includedButtons: [{ type: Input, args: ['include',] }],
        excludedButtons: [{ type: Input, args: ['exclude',] }],
        shownButtons: [{ type: Input, args: ['show',] }],
        url: [{ type: Input }],
        title: [{ type: Input }],
        description: [{ type: Input }],
        image: [{ type: Input }],
        tags: [{ type: Input }],
        autoSetMeta: [{ type: Input }],
        showIcon: [{ type: Input }],
        showText: [{ type: Input }],
        showCount: [{ type: Input }],
        size: [{ type: Input }],
        count: [{ type: Output }],
        opened: [{ type: Output }],
        closed: [{ type: Output }]
    };
    return ShareButtonsComponent;
}());
export { ShareButtonsComponent };
function ShareButtonsComponent_tsickle_Closure_declarations() {
    /** @type {?} */
    ShareButtonsComponent.prototype.state$;
    /** @type {?} */
    ShareButtonsComponent.prototype._stateWorker$;
    /** @type {?} */
    ShareButtonsComponent.prototype._configSub$;
    /** @type {?} */
    ShareButtonsComponent.prototype.theme;
    /**
     * Share meta tags
     * @type {?}
     */
    ShareButtonsComponent.prototype.url;
    /** @type {?} */
    ShareButtonsComponent.prototype.title;
    /** @type {?} */
    ShareButtonsComponent.prototype.description;
    /** @type {?} */
    ShareButtonsComponent.prototype.image;
    /** @type {?} */
    ShareButtonsComponent.prototype.tags;
    /**
     * Set meta tags from document head, useful when SEO is supported
     * @type {?}
     */
    ShareButtonsComponent.prototype.autoSetMeta;
    /**
     * Show buttons icon
     * @type {?}
     */
    ShareButtonsComponent.prototype.showIcon;
    /**
     * Show buttons name
     * @type {?}
     */
    ShareButtonsComponent.prototype.showText;
    /**
     * Show buttons share count
     * @type {?}
     */
    ShareButtonsComponent.prototype.showCount;
    /**
     * Buttons size
     * @type {?}
     */
    ShareButtonsComponent.prototype.size;
    /**
     * Share count event
     * @type {?}
     */
    ShareButtonsComponent.prototype.count;
    /**
     * Share dialog opened event
     * @type {?}
     */
    ShareButtonsComponent.prototype.opened;
    /**
     * Share dialog closed event
     * @type {?}
     */
    ShareButtonsComponent.prototype.closed;
    /** @type {?} */
    ShareButtonsComponent.prototype._share;
}
/**
 * Explanation of the above code:
 * ------------------------------
 Include buttons: includes only wanted buttons and excludes the rest
 Exclude buttons: excludes only the unwanted buttons
 User buttons = Include buttons - exclude buttons
 Selected Buttons = User buttons [shown number]

 =====================================================================================

 Why do we use both include and exclude inputs?

 Because it is easier for users who want to disable one button to use [exclude] input instead of writing an array of all included buttons
 And it is easier for users who want to enable only one button to use [include] input instead of writing an array of all excluded buttons
 */

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhcmUtYnV0dG9ucy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Abmd4LXNoYXJlL2J1dHRvbnMvIiwic291cmNlcyI6WyJsaWIvc2hhcmUtYnV0dG9ucy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQXFCLFlBQVksRUFBRSx1QkFBdUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNuSCxPQUFPLEVBQUUsWUFBWSxFQUFzQixNQUFNLGlCQUFpQixDQUFDO0FBQ25FLE9BQU8sRUFBYyxlQUFlLEVBQWdCLE1BQU0sTUFBTSxDQUFDO0FBQ2pFLE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBNkduQywrQkFBb0IsTUFBb0I7UUFBcEIsV0FBTSxHQUFOLE1BQU0sQ0FBYzs2QkF4RGhCLElBQUksZUFBZSxDQUFlO1lBQ3hELGVBQWUsRUFBRSxFQUFFO1lBQ25CLGVBQWUsRUFBRSxFQUFFO1lBQ25CLFdBQVcsRUFBRSxFQUFFO1lBQ2YsZUFBZSxFQUFFLEVBQUU7WUFDbkIsUUFBUSxFQUFFLElBQUk7WUFDZCxVQUFVLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNO1NBQ3hELENBQUM7cUJBSWUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLOzs7O3dCQXlCZCxJQUFJOzs7O3dCQUdKLEtBQUs7Ozs7eUJBR0osS0FBSzs7OztvQkFHVixDQUFDOzs7O3FCQUdDLElBQUksWUFBWSxFQUFVOzs7O3NCQUd6QixJQUFJLFlBQVksRUFBVTs7OztzQkFHMUIsSUFBSSxZQUFZLEVBQVU7S0FHNUM7SUE1Q0Qsc0JBQXNCLGtEQUFlOzs7OztRQUFyQyxVQUFzQyxlQUF5QjtZQUM3RCxJQUFJLENBQUMsV0FBVyxDQUFD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QUssRUFBRSxDQUFDO0tBQ3ZFOztnQkE1SUYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxlQUFlO29CQUN6QixRQUFRLEVBQUUseXFDQStCWDtvQkFDQyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtvQkFDL0MsbUJBQW1CLEVBQUUsS0FBSztpQkFDM0I7Ozs7Z0JBbkRRLFlBQVk7Ozt3QkFrRWxCLEtBQUs7a0NBRUwsS0FBSyxTQUFDLFNBQVM7a0NBSWYsS0FBSyxTQUFDLFNBQVM7K0JBSWYsS0FBSyxTQUFDLE1BQU07c0JBS1osS0FBSzt3QkFDTCxLQUFLOzhCQUNMLEtBQUs7d0JBQ0wsS0FBSzt1QkFDTCxLQUFLOzhCQUdMLEtBQUs7MkJBR0wsS0FBSzsyQkFHTCxLQUFLOzRCQUdMLEtBQUs7dUJBR0wsS0FBSzt3QkFHTCxNQUFNO3lCQUdOLE1BQU07eUJBR04sTUFBTTs7Z0NBOUdUOztTQXFEYSxxQkFBcUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPdXRwdXQsIE9uSW5pdCwgT25EZXN0cm95LCBFdmVudEVtaXR0ZXIsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFNoYXJlQnV0dG9ucywgU2hhcmVCdXR0b25zQ29uZmlnIH0gZnJvbSAnQG5neC1zaGFyZS9jb3JlJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgQmVoYXZpb3JTdWJqZWN0LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBCdXR0b25zU3RhdGUge1xyXG4gIGluY2x1ZGVkQnV0dG9ucz86IHN0cmluZ1tdO1xyXG4gIGV4Y2x1ZGVkQnV0dG9ucz86IHN0cmluZ1tdO1xyXG4gIHVzZXJCdXR0b25zPzogc3RyaW5nW107XHJcbiAgc2VsZWN0ZWRCdXR0b25zPzogc3RyaW5nW107XHJcbiAgZXhwYW5kZWQ/OiBib29sZWFuO1xyXG4gIHNob3duQ291bnQ/OiBudW1iZXI7XHJcbiAgbW9yZUljb24/OiBhbnk7XHJcbiAgbGVzc0ljb24/OiBhbnk7XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnc2hhcmUtYnV0dG9ucycsXHJcbiAgdGVtcGxhdGU6IGA8ZGl2ICpuZ0lmPVwic3RhdGUkIHwgYXN5bmM7IGxldCBzdGF0ZVwiIGNsYXNzPVwic2ItZ3JvdXAgc2Ite3t0aGVtZX19XCI+XHJcblxyXG4gIDxzaGFyZS1idXR0b24gKm5nRm9yPVwibGV0IGJ1dHRvbiBvZiBzdGF0ZS5zZWxlY3RlZEJ1dHRvbnNcIlxyXG4gICAgICAgICAgICAgICAgW2J1dHRvbl09XCJidXR0b25cIlxyXG4gICAgICAgICAgICAgICAgW3RoZW1lXT1cInRoZW1lXCJcclxuICAgICAgICAgICAgICAgIFt1cmxdPVwidXJsXCJcclxuICAgICAgICAgICAgICAgIFt0aXRsZV09XCJ0aXRsZVwiXHJcbiAgICAgICAgICAgICAgICBbZGVzY3JpcHRpb25dPVwiZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgICAgICAgW2ltYWdlXT1cImltYWdlXCJcclxuICAgICAgICAgICAgICAgIFt0YWdzXT1cInRhZ3NcIlxyXG4gICAgICAgICAgICAgICAgW2F1dG9TZXRNZXRhXT1cImF1dG9TZXRNZXRhXCJcclxuICAgICAgICAgICAgICAgIFtzaG93Q291bnRdPVwic2hvd0NvdW50XCJcclxuICAgICAgICAgICAgICAgIFtzaG93SWNvbl09XCJzaG93SWNvblwiXHJcbiAgICAgICAgICAgICAgICBbc2hvd1RleHRdPVwic2hvd1RleHRcIlxyXG4gICAgICAgICAgICAgICAgW3NpemVdPVwic2l6ZVwiXHJcbiAgICAgICAgICAgICAgICAob3BlbmVkKT1cIm9wZW5lZC5lbWl0KCRldmVudClcIlxyXG4gICAgICAgICAgICAgICAgKGNsb3NlZCk9XCJjbG9zZWQuZW1pdCgkZXZlbnQpXCJcclxuICAgICAgICAgICAgICAgIChjb3VudCk9XCJjb3VudC5lbWl0KCRldmVudClcIj48L3NoYXJlLWJ1dHRvbj5cclxuXHJcbiAgPGRpdiBjbGFzcz1cInNiLWJ1dHRvbiBzYi17e3RoZW1lfX1cIj5cclxuXHJcbiAgICA8ZXhwYW5kLWJ1dHRvbiAqbmdJZj1cInN0YXRlLnNob3duQ291bnQgPCBzdGF0ZS51c2VyQnV0dG9ucy5sZW5ndGhcIlxyXG4gICAgICAgICAgICAgICAgICAgW2V4cGFuZGVkXT1cInN0YXRlLmV4cGFuZGVkXCJcclxuICAgICAgICAgICAgICAgICAgIFttb3JlSWNvbl09XCJzdGF0ZS5tb3JlSWNvblwiXHJcbiAgICAgICAgICAgICAgICAgICBbbGVzc0ljb25dPVwic3RhdGUubGVzc0ljb25cIlxyXG4gICAgICAgICAgICAgICAgICAgW3NpemVdPVwiKDEgKyBzaXplLzIwKSAqIDE0XCJcclxuICAgICAgICAgICAgICAgICAgICh0b2dnbGUpPVwidXBkYXRlU3RhdGUoe2V4cGFuZGVkOiAkZXZlbnR9KVwiPlxyXG4gICAgPC9leHBhbmQtYnV0dG9uPlxyXG5cclxuICA8L2Rpdj5cclxuPC9kaXY+XHJcbmAsXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXHJcbiAgcHJlc2VydmVXaGl0ZXNwYWNlczogZmFsc2VcclxufSlcclxuZXhwb3J0IGNsYXNzIFNoYXJlQnV0dG9uc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcclxuXHJcbiAgc3RhdGUkOiBPYnNlcnZhYmxlPEJ1dHRvbnNTdGF0ZT47XHJcbiAgcHJpdmF0ZSBfc3RhdGVXb3JrZXIkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxCdXR0b25zU3RhdGU+KHtcclxuICAgIGluY2x1ZGVkQnV0dG9uczogW10sXHJcbiAgICBleGNsdWRlZEJ1dHRvbnM6IFtdLFxyXG4gICAgdXNlckJ1dHRvbnM6IFtdLFxyXG4gICAgc2VsZWN0ZWRCdXR0b25zOiBbXSxcclxuICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgc2hvd25Db3VudDogT2JqZWN0LmtleXModGhpcy5fc2hhcmUuY29uZmlnLnByb3ApLmxlbmd0aFxyXG4gIH0pO1xyXG5cclxuICBwcml2YXRlIF9jb25maWdTdWIkOiBTdWJzY3JpcHRpb247XHJcblxyXG4gIEBJbnB1dCgpIHRoZW1lID0gdGhpcy5fc2hhcmUudGhlbWU7XHJcblxyXG4gIEBJbnB1dCgnaW5jbHVkZScpIHNldCBpbmNsdWRlZEJ1dHRvbnMoaW5jbHVkZWRCdXR0b25zOiBzdHJpbmdbXSkge1xyXG4gICAgdGhpcy51cGRhdGVTdGF0ZSh7aW5jbHVkZWRCdXR0b25zfSk7XHJcbiAgfVxyXG5cclxuICBASW5wdXQoJ2V4Y2x1ZGUnKSBzZXQgZXhjbHVkZWRCdXR0b25zKGV4Y2x1ZGVkQnV0dG9uczogc3RyaW5nW10pIHtcclxuICAgIHRoaXMudXBkYXRlU3RhdGUoe2V4Y2x1ZGVkQnV0dG9uc30pO1xyXG4gIH1cclxuXHJcbiAgQElucHV0KCdzaG93Jykgc2V0IHNob3duQnV0dG9ucyhzaG93bkNvdW50OiBudW1iZXIpIHtcclxuICAgIHRoaXMudXBkYXRlU3RhdGUoe3Nob3duQ291bnR9KTtcclxuICB9XHJcblxyXG4gIC8qKiBTaGFyZSBtZXRhIHRhZ3MgKi9cclxuICBASW5wdXQoKSB1cmw6IHN0cmluZztcclxuICBASW5wdXQoKSB0aXRsZTogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgaW1hZ2U6IHN0cmluZztcclxuICBASW5wdXQoKSB0YWdzOiBzdHJpbmc7XHJcblxyXG4gIC8qKiBTZXQgbWV0YSB0YWdzIGZyb20gZG9jdW1lbnQgaGVhZCwgdXNlZnVsIHdoZW4gU0VPIGlzIHN1cHBvcnRlZCAqL1xyXG4gIEBJbnB1dCgpIGF1dG9TZXRNZXRhOiBib29sZWFuO1xyXG5cclxuICAvKiogU2hvdyBidXR0b25zIGljb24gKi9cclxuICBASW5wdXQoKSBzaG93SWNvbiA9IHRydWU7XHJcblxyXG4gIC8qKiBTaG93IGJ1dHRvbnMgbmFtZSAqL1xyXG4gIEBJbnB1dCgpIHNob3dUZXh0ID0gZmFsc2U7XHJcblxyXG4gIC8qKiBTaG93IGJ1dHRvbnMgc2hhcmUgY291bnQgKi9cclxuICBASW5wdXQoKSBzaG93Q291bnQgPSBmYWxzZTtcclxuXHJcbiAgLyoqIEJ1dHRvbnMgc2l6ZSAqL1xyXG4gIEBJbnB1dCgpIHNpemUgPSAwO1xyXG5cclxuICAvKiogU2hhcmUgY291bnQgZXZlbnQgKi9cclxuICBAT3V0cHV0KCkgY291bnQgPSBuZXcgRXZlbnRFbWl0dGVyPG51bWJlcj4oKTtcclxuXHJcbiAgLyoqIFNoYXJlIGRpYWxvZyBvcGVuZWQgZXZlbnQgKi9cclxuICBAT3V0cHV0KCkgb3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XHJcblxyXG4gIC8qKiBTaGFyZSBkaWFsb2cgY2xvc2VkIGV2ZW50ICovXHJcbiAgQE91dHB1dCgpIGNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIF9zaGFyZTogU2hhcmVCdXR0b25zKSB7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuc3RhdGUkID0gdGhpcy5fc3RhdGVXb3JrZXIkLnBpcGUoXHJcbiAgICAgIG1hcCgoc3RhdGU6IEJ1dHRvbnNTdGF0ZSkgPT4ge1xyXG4gICAgICAgIC8vIFVzZSBjb21wb25lbnQgaW5jbHVkZSBidXR0b25zLCBvdGhlcndpc2UgZmFsbGJhY2sgdG8gZ2xvYmFsIGluY2x1ZGUgYnV0dG9uc1xyXG4gICAgICAgIGNvbnN0IGluY2x1ZGVkQnV0dG9ucyA9IHN0YXRlLmluY2x1ZGVkQnV0dG9ucy5sZW5ndGggPyBzdGF0ZS5pbmNsdWRlZEJ1dHRvbnMgOiBzdGF0ZS51c2VyQnV0dG9ucztcclxuICAgICAgICBjb25zdCB1c2VyQnV0dG9ucyA9IGluY2x1ZGVkQnV0dG9ucy5maWx0ZXIoKGJ0bikgPT4gc3RhdGUuZXhjbHVkZWRCdXR0b25zLmluZGV4T2YoYnRuKSA8IDApO1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkQnV0dG9ucyA9IHVzZXJCdXR0b25zLnNsaWNlKDAsIHN0YXRlLmV4cGFuZGVkID8gdXNlckJ1dHRvbnMubGVuZ3RoIDogc3RhdGUuc2hvd25Db3VudCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHVzZXJCdXR0b25zLFxyXG4gICAgICAgICAgc2VsZWN0ZWRCdXR0b25zLFxyXG4gICAgICAgICAgZXhwYW5kZWQ6IHN0YXRlLmV4cGFuZGVkLFxyXG4gICAgICAgICAgc2hvd25Db3VudDogc3RhdGUuc2hvd25Db3VudCxcclxuICAgICAgICAgIG1vcmVJY29uOiBzdGF0ZS5tb3JlSWNvbixcclxuICAgICAgICAgIGxlc3NJY29uOiBzdGF0ZS5sZXNzSWNvblxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8qKiBTdWJzY3JpYmUgdG8gc2hhcmUgYnV0dG9ucyBjb25maWcgY2hhbmdlcywgVGhpcyB1cGRhdGVzIHRoZSBjb21wb25lbnQgd2hlbmV2ZXIgYSBuZXcgYnV0dG9uIGlzIGFkZGVkICovXHJcbiAgICB0aGlzLl9jb25maWdTdWIkID0gdGhpcy5fc2hhcmUuY29uZmlnJC5zdWJzY3JpYmUoKGNvbmZpZzogU2hhcmVCdXR0b25zQ29uZmlnKSA9PiB7XHJcbiAgICAgIC8vIFVzZSBnbG9iYWwgaW5jbHVkZSBidXR0b25zLCBvdGhlcndpc2UgZmFsbGJhY2sgdG8gYWxsIGJ1dHRvbnNcclxuICAgICAgY29uc3QgaW5jbHVkZWRCdXR0b25zID0gY29uZmlnLm9wdGlvbnMuaW5jbHVkZS5sZW5ndGggPyBjb25maWcub3B0aW9ucy5pbmNsdWRlIDogT2JqZWN0LmtleXMoY29uZmlnLnByb3ApO1xyXG4gICAgICBjb25zdCB1c2VyQnV0dG9ucyA9IGluY2x1ZGVkQnV0dG9ucy5maWx0ZXIoKGJ0bikgPT4gY29uZmlnLm9wdGlvbnMuZXhjbHVkZS5pbmRleE9mKGJ0bikgPCAwKTtcclxuICAgICAgdGhpcy51cGRhdGVTdGF0ZSh7XHJcbiAgICAgICAgdXNlckJ1dHRvbnMsXHJcbiAgICAgICAgZXhwYW5kZWQ6IGZhbHNlLFxyXG4gICAgICAgIG1vcmVJY29uOiBjb25maWcub3B0aW9ucy5tb3JlQnV0dG9uSWNvbixcclxuICAgICAgICBsZXNzSWNvbjogY29uZmlnLm9wdGlvbnMubGVzc0J1dHRvbkljb25cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCkge1xyXG4gICAgaWYgKHRoaXMuX2NvbmZpZ1N1YiQpIHtcclxuICAgICAgdGhpcy5fY29uZmlnU3ViJC51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fc3RhdGVXb3JrZXIkLmNvbXBsZXRlKCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVTdGF0ZShzdGF0ZTogQnV0dG9uc1N0YXRlKSB7XHJcbiAgICB0aGlzLl9zdGF0ZVdvcmtlciQubmV4dCh7Li4udGhpcy5fc3RhdGVXb3JrZXIkLmdldFZhbHVlKCksIC4uLnN0YXRlfSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuLyoqXHJcbiAqIEV4cGxhbmF0aW9uIG9mIHRoZSBhYm92ZSBjb2RlOlxyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuIEluY2x1ZGUgYnV0dG9uczogaW5jbHVkZXMgb25seSB3YW50ZWQgYnV0dG9ucyBhbmQgZXhjbHVkZXMgdGhlIHJlc3RcclxuIEV4Y2x1ZGUgYnV0dG9uczogZXhjbHVkZXMgb25seSB0aGUgdW53YW50ZWQgYnV0dG9uc1xyXG4gVXNlciBidXR0b25zID0gSW5jbHVkZSBidXR0b25zIC0gZXhjbHVkZSBidXR0b25zXHJcbiBTZWxlY3RlZCBCdXR0b25zID0gVXNlciBidXR0b25zIFtzaG93biBudW1iZXJdXHJcblxyXG4gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuIFdoeSBkbyB3ZSB1c2UgYm90aCBpbmNsdWRlIGFuZCBleGNsdWRlIGlucHV0cz9cclxuXHJcbiBCZWNhdXNlIGl0IGlzIGVhc2llciBmb3IgdXNlcnMgd2hvIHdhbnQgdG8gZGlzYWJsZSBvbmUgYnV0dG9uIHRvIHVzZSBbZXhjbHVkZV0gaW5wdXQgaW5zdGVhZCBvZiB3cml0aW5nIGFuIGFycmF5IG9mIGFsbCBpbmNsdWRlZCBidXR0b25zXHJcbiBBbmQgaXQgaXMgZWFzaWVyIGZvciB1c2VycyB3aG8gd2FudCB0byBlbmFibGUgb25seSBvbmUgYnV0dG9uIHRvIHVzZSBbaW5jbHVkZV0gaW5wdXQgaW5zdGVhZCBvZiB3cml0aW5nIGFuIGFycmF5IG9mIGFsbCBleGNsdWRlZCBidXR0b25zXHJcbiAqL1xyXG4iXX0=